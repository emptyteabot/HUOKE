# LeadPulse 项目审计与功能状态报告（2026-02-24）

## 1. 结论（先看）
- 结论1：当前不是“每一个功能都无条件可用”。
- 结论2：在**本地模式**下，Web SaaS 核心流程可用：`作战中枢 -> 获客 -> 线索池 -> AI销售 -> 数据分析 -> 线索包`。
- 结论3：涉及第三方服务的功能为“条件可用”，需要对应密钥或云配置。

## 2. 审计范围与方法
### 2.1 文件扫描范围
- 已遍历项目文件路径：`5487` 个。
- 其中包含大量历史数据、缓存与浏览器 profile 文件（尤其 `chrome_profile/` 与 `data/`）。
- 排除 `chrome_profile/` 后可见业务文件规模约：`1651` 个。

### 2.2 核心代码审查目录（逐文件重点）
- `streamlit-app/`（主产品）
- `streamlit-app/services/`（AI销售与分析）
- `openclaw_realtime_sync.py`（本地到云/本地同步）
- `backend/`、`frontend/`、`frontend-b2b/`（存在，但当前线上主站入口不是这些）

### 2.3 实测方式
- 语法编译检查（核心模块）
- 同步脚本 dry-run
- 本地数据库读写 smoke test（建用户、建线索、读取）
- 最新线索数据与心跳文件状态读取
- 线上地址可达性检查

## 3. 这个项目现在是什么产品
当前已经实现的是一个**留学垂直赛道的 AI 获客 Web SaaS**（以 Streamlit 为主入口），主价值链路：
1. 读取本地/同步来的社媒线索数据
2. 规则+意图分筛选，排除机构号
3. 将高价值线索同步进线索池
4. AI 销售文案生成与回复分诊（含转人工阈值）
5. 渠道 ROI / CAC / A-B 显著性分析
6. 线索包订单化交付（CSV）

线上主入口：`streamlit-app/Home.py`

## 4. 功能状态矩阵（按“能不能用”）
| 模块 | 状态 | 说明 | 依赖 |
|---|---|---|---|
| 作战中枢（Manus风格工作台） | 可用 | 已接入全链路总览、执行计划与快捷动作 | 无强依赖 |
| 获客页（数据读取+筛选+同步） | 可用 | 支持本地文件、远端同步线索、筛选后入池 | 数据文件存在 |
| 线索池 CRUD | 可用 | 本地模式可写入、查询、状态更新 | 无强依赖 |
| AI销售（文案生成） | 可用（降级） | 无 OpenAI Key 时走 fallback 文案 | `OPENAI_API_KEY` 可选 |
| AI销售（回复分诊+Webhook） | 可用（条件） | 分诊可用；Webhook 需有效地址 | Webhook URL 可选 |
| 数据分析（ROI/CAC/A-B） | 可用 | 依赖已有 leads/emails 数据 | 需要先有数据 |
| 线索包订单与本地CSV导出 | 可用 | 订单创建、处理、导出可用 | 无强依赖 |
| 线索包邮件交付 | 条件可用 | 需 SendGrid 配置，否则标记 failed | `SENDGRID_API_KEY` |
| 订阅支付（Billing） | 条件可用 | 需 Stripe key 与 price id | `STRIPE_*` |
| Supabase 云同步 | 条件可用 | 未配时自动退化 `local_only` | `SUPABASE_URL/KEY` |
| 访客自动登录 | 可用 | 已实现本地兜底会话登录 | 无强依赖 |

## 5. 实测结果（2026-02-24）
### 5.1 核心模块编译
- 命令：`python -m py_compile streamlit-app/... openclaw_realtime_sync.py`
- 结果：通过。

### 5.2 同步脚本 dry-run
- 命令：`python openclaw_realtime_sync.py --user-id dryrun-user --dry-run`
- 输出核心结果：
  - `source_total = 554`
  - `mode = local_only`
  - `cloud_enabled = False`
- 结论：在未配置 Supabase 的情况下，脚本可运行并正常降级。

### 5.3 本地数据库 smoke test
- 结果：成功创建用户、写入线索并读取（`smoke_lead_count = 1`）。
- 结论：本地数据库后端可用。

### 5.4 最新线索数据状态
- 最新导出文件：`data/exports/high_value_leads_20260224_173816.csv`
- 行数：`277`
- 带主页可私信链接：`94`
- 心跳文件：`data/openclaw/sync_heartbeat.json`
  - `status = local_only`
  - `last_error = (空)`

### 5.5 线上可达
- `https://ai-huoke.streamlit.app/` 返回 `HTTP 200`。

## 6. 最近上线变更（与你目标直接相关）
- `f06d8dc`：本地 OpenClaw 到云端实时 feed + 乱码清理
- `2ac60c5`：本地模式兜底、访客自动登录、中文化清理
- `4a27f06`：作战中枢（Manus化）与全流程工作台
- `9481ab7`：修复顶部导航遮挡首屏问题

## 7. 当前问题与风险
1. 仓库噪音很大：大量历史脚本、重复方案、缓存文件混在主仓库，维护成本高。
2. 文档与代码存在代际混杂：旧文档有乱码和过期描述，容易误导。
3. 多技术栈并存（Streamlit + Next + TS backend），但线上主入口是 Streamlit，容易造成“看起来很多、实际上没串起来”的错觉。
4. 第三方服务依赖（Supabase/Stripe/SendGrid）未统一配置时，相关能力只能降级或不可用。

## 8. 建议的产品化收敛路线（按优先级）
1. **单一主干**：明确“线上唯一入口=Streamlit”或“迁移到 Next.js”，避免双主线。
2. **仓库清理**：把 `chrome_profile/`、历史脚本、临时报告迁移到归档目录或独立仓库。
3. **配置分层**：建立 `.env.example` + `secrets` 模板，一次性写清必需配置。
4. **最小回归测试**：为 6 条主流程加自动 smoke test（登录、获客同步、线索入池、AI销售、分析、线索包）。
5. **数据质量基线**：给“机构排除、DM可达、意向分”建立固定评估报表，避免盲目增量。

---

如果你要一句话定义当前产品：

> 这是一个“已能跑通本地闭环、可对外演示并可小规模交付”的留学 AI 获客 SaaS，距离“全功能云端商业化稳定版”还差外部依赖配置统一、仓库收敛和自动化测试三步。
